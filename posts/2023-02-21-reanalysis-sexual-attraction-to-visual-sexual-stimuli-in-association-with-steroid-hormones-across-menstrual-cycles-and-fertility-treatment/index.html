<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>One lives only to make blunders: Reanalysis: Sexual attraction to visual sexual stimuli and hormones</title>

<meta property="description" itemprop="description" content="Analyzing the public data shared along with a recent publication by Schön et al. (2023): Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment"/>

<link rel="canonical" href="https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-02-22"/>
<meta property="article:created" itemprop="dateCreated" content="2023-02-22"/>
<meta name="article:author" content="Ruben C. Arslan"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="One lives only to make blunders: Reanalysis: Sexual attraction to visual sexual stimuli and hormones"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Analyzing the public data shared along with a recent publication by Schön et al. (2023): Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment"/>
<meta property="og:url" content="https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="One lives only to make blunders"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="One lives only to make blunders: Reanalysis: Sexual attraction to visual sexual stimuli and hormones"/>
<meta property="twitter:description" content="Analyzing the public data shared along with a recent publication by Schön et al. (2023): Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment"/>
<meta property="twitter:url" content="https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/"/>
<meta property="twitter:site" content="@rubenarslan"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="One lives only to make blunders: Reanalysis: Sexual attraction to visual sexual stimuli and hormones"/>
<meta name="citation_fulltext_html_url" content="https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/02/22"/>
<meta name="citation_publication_date" content="2023/02/22"/>
<meta name="citation_author" content="Ruben C. Arslan"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","categories","output","preview","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Reanalysis: Sexual attraction to visual sexual stimuli and hormones"]},{"type":"character","attributes":{},"value":["Analyzing the public data shared along with a recent publication by Schön et al. (2023): Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Ruben C. Arslan"]},{"type":"character","attributes":{},"value":["https://rubenarslan.github.io"]}]}]},{"type":"character","attributes":{},"value":["2023-02-22"]},{"type":"character","attributes":{},"value":["hormones","hibar"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://ars.els-cdn.com/content/image/1-s2.0-S0306453023000380-gr1.jpg"]},{"type":"character","attributes":{},"value":["https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/"]},{"type":"character","attributes":{},"value":["https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/anchor-4.2.2/anchor.min.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/bowser-1.9.3/bowser.min.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/distill-2.2.21/template.v2.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-13-1.png","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-14-1.png","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-4-1.png","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-6-1.png","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-7-1.png","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/header-attrs-2.17/header-attrs.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/jquery-3.6.0/jquery-3.6.0.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/jquery-3.6.0/jquery-3.6.0.min.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/jquery-3.6.0/jquery-3.6.0.min.map","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/popper-2.6.0/popper.min.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/tippy-6.2.7/tippy-bundle.umd.min.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/tippy-6.2.7/tippy-light-border.css","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/tippy-6.2.7/tippy.css","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/tippy-6.2.7/tippy.umd.min.js","reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/webcomponents-2.0.0/webcomponents.js","ScienceDirect_files_21Feb2023_09-06-38.857/1-s2.0-S0306453023000380-mmc5.docx","ScienceDirect_files_21Feb2023_09-06-38.857/1-s2.0-S0306453023000380-mmc6.docx","ScienceDirect_files_21Feb2023_09-06-38.857/mmc1/SPSS Code_Cycle_1_2.sps","ScienceDirect_files_21Feb2023_09-06-38.857/mmc2/SPSS Code_IVF.sps","ScienceDirect_files_21Feb2023_09-06-38.857/mmc3/SPSS_Dataset_Cycle_1_2.sav","ScienceDirect_files_21Feb2023_09-06-38.857/mmc4/SPSS_Dataset_IVF.sav"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.17/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-2102103-6"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-2102103-6');
</script>
<style type="text/css">
.distill-site-nav {
  color: #E4F2F7;
  background-color: #4F94B0;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a:hover {
  color: white;
}

.img-circle {
  width:200px;
  border-radius: 25%;
}
@media(min-width:768px) {
    aside {
        margin-bottom: -500px;
    }
}
.figure img.external {
  padding: 6px;
}

</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Reanalysis: Sexual attraction to visual sexual stimuli and hormones","description":"Analyzing the public data shared along with a recent publication by Schön et al. (2023): Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment","authors":[{"author":"Ruben C. Arslan","authorURL":"https://rubenarslan.github.io","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-02-22T00:00:00.000+01:00","citationText":"Arslan, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">One lives only to make blunders</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../blog.html">Blog</a>
<a href="http://www.the100.ci/author/ruben/">Group Blog</a>
<a href="../../bug_bounty.html">Bug Bounty</a>
<a href="../../mistakes.html">Mistakes</a>
<a href="../../cv_ruben_arslan.pdf">CV</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Reanalysis: Sexual attraction to visual sexual stimuli and hormones</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../blog.html#category:hormones" class="dt-tag">hormones</a>
  <a href="../../blog.html#category:hibar" class="dt-tag">hibar</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Analyzing the public data shared along with a recent publication by Schön et al. (2023): Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment</p></p>
</div>

<div class="d-byline">
  Ruben C. Arslan <a href="https://rubenarslan.github.io" class="uri">https://rubenarslan.github.io</a> 
  
<br/>2023-02-22
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#accuracy-of-our-estradiol-and-progesterone-imputations" id="toc-accuracy-of-our-estradiol-and-progesterone-imputations">Accuracy of our estradiol and progesterone imputations</a></li>
<li><a href="#slightly-different-analyses" id="toc-slightly-different-analyses">Slightly different analyses</a>
<ul>
<li><a href="#multilevel-generalizability" id="toc-multilevel-generalizability">Multilevel generalizability</a></li>
<li><a href="#a-multivariate-model" id="toc-a-multivariate-model">A multivariate model</a></li>
<li><a href="#a-location-scale-model" id="toc-a-location-scale-model">A location-scale model</a></li>
<li><a href="#group-mean-centering" id="toc-group-mean-centering">Group mean centering</a></li>
<li><a href="#latent-group-mean-centering" id="toc-latent-group-mean-centering">Latent group mean centering</a></li>
<li><a href="#imputations-and-lag" id="toc-imputations-and-lag">Imputations and lag</a></li>
<li><a href="#latent-lag" id="toc-latent-lag">Latent lag</a></li>
<li><a href="#bringing-it-all-together" id="toc-bringing-it-all-together">Bringing it all together</a></li>
</ul></li>
<li><a href="#conclusion" id="toc-conclusion">“Conclusion”</a>
<ul>
<li><a href="#things-i-didnt-do-or-that-still-confuse-me" id="toc-things-i-didnt-do-or-that-still-confuse-me">Things I didn’t do or that still confuse me</a></li>
</ul></li>
</ul>
</nav>
</div>
<!--
## Notes:
- Still haven't figured out what Vuorre's syntax does
- I can reproduce his results, but neither depb nor depCB appear in the data, I had previously misunderstood this. I don't know how brms knows to subtract the mean of dep given that no observed variable related to dep shows up in the syntax.
- My application to logOESTR was incorrect (huge SEs)
- Would be cool to apply this to location scale models
-->
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># importing the data downloaded from the supplementary here https://www.sciencedirect.com/science/article/pii/S0306453023000380#sec0115</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>cycles</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"ScienceDirect_files_21Feb2023_09-06-38.857/mmc3/SPSS_Dataset_Cycle_1_2.sav"</span><span class='op'>)</span></span>
<span><span class='co'># cycles %&gt;% names()</span></span>
<span></span>
<span><span class='co'># cycles %&gt;% select(starts_with("Z"))</span></span>
<span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"Z"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cycle"</span>, <span class='st'>"time"</span>, <span class='st'>"name"</span><span class='op'>)</span>, extra <span class='op'>=</span> <span class='st'>"merge"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># unique(cycles_long$cycle)</span></span>
<span><span class='co'># unique(cycles_long$time)</span></span>
<span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>fc_day <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='st'>"T1"</span> <span class='op'>=</span> <span class='st'>"4"</span>, </span>
<span>                         <span class='st'>"T2"</span> <span class='op'>=</span> <span class='st'>"13"</span>,</span>
<span>                         <span class='st'>"T3"</span> <span class='op'>=</span> <span class='st'>"21"</span>,</span>
<span>                         <span class='st'>"T4"</span> <span class='op'>=</span> <span class='st'>"28"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='va'>cycles_long</span><span class='op'>$</span><span class='va'>fc_day</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span>exclude<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>.
  3  12  20  27 
180 180 180 180 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>logOESTR <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>OESTR</span><span class='op'>)</span>, logPROG <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROG</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lead2</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle</span>, <span class='va'>fc_day</span>, logOESTR_lag2 <span class='op'>=</span> <span class='va'>logOESTR</span>, logPROG_lag2 <span class='op'>=</span> <span class='va'>logPROG</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>fc_day <span class='op'>=</span> <span class='va'>fc_day</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate_all.html'>mutate_at</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"SR_"</span><span class='op'>)</span><span class='op'>)</span>, <span class='op'>~</span> <span class='op'>(</span><span class='va'>.</span> <span class='op'>-</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>20</span> <span class='op'>)</span></span>
<span></span>
<span><span class='va'>cycles_longer</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'>tidyr</span><span class='fu'>::</span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand.html'>expand</a></span><span class='op'>(</span>fc_day <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>5</span>, <span class='fl'>12</span>, <span class='fl'>14</span>, <span class='fl'>20</span>, <span class='fl'>22</span>, <span class='fl'>27</span>, <span class='fl'>29</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>full_join</a></span><span class='op'>(</span><span class='va'>cycles_long</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID"</span>, <span class='st'>"cycle"</span>, <span class='st'>"fc_day"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>lead2</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID"</span>, <span class='st'>"cycle"</span>, <span class='st'>"fc_day"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>fc_day_lag2 <span class='op'>=</span> <span class='va'>fc_day</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># table(cycles_longer$fc_day)</span></span>
<span><span class='co'># table(cycles_longer$fc_day_lag2)</span></span>
<span></span>
<span><span class='va'>fc_days</span> <span class='op'>&lt;-</span> <span class='fu'>rio</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rio/man/import.html'>import</a></span><span class='op'>(</span><span class='st'>"https://files.osf.io/v1/resources/u9xad/providers/github/merge_files/fc_days.sav"</span><span class='op'>)</span></span>
<span><span class='va'>cycles_longer</span> <span class='op'>&lt;-</span> <span class='va'>cycles_longer</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>fc_days</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fc_day"</span> <span class='op'>=</span> <span class='st'>"fc_day"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>cycles_longer</span> <span class='op'>&lt;-</span> <span class='va'>cycles_longer</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>fc_days</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename_with</a></span><span class='op'>(</span><span class='op'>~</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>.</span>, <span class='st'>"_lag2"</span><span class='op'>)</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fc_day_lag2"</span> <span class='op'>=</span> <span class='st'>"fc_day_lag2"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='co'># ggplot(cycles_long, aes(fc_day, log(OESTR))) + geom_point() + geom_smooth()</span></span>
<span><span class='co'># ggplot(cycles_longer, aes(fc_day, logOESTR_lag2)) + geom_point() + geom_smooth()</span></span>
<span><span class='co'># ggplot(cycles_long, aes(fc_day, log(PROG))) + geom_point() + geom_smooth()</span></span>
<span><span class='co'># ggplot(cycles_longer, aes(log(OESTR), est_estradiol_fc)) + geom_point()</span></span>
<span></span>
<span><span class='co'># lm(log(OESTR) ~ est_estradiol_fc, cycles_longer)</span></span>
<span><span class='co'># lm(log(PROG) ~ est_progesterone_fc, cycles_longer)</span></span></code></pre>
</div>
</details>
</div>
<p>The following paper was recently published by Schön et al. in Psychoneuroendocrinology: <a href="https://www.sciencedirect.com/science/article/pii/S0306453023000380#bib20">Sexual attraction to visual sexual stimuli in association with steroid hormones across menstrual cycles and fertility treatment, doi:10.1016/j.psyneuen.2023.106060</a></p>
<details>
<summary>
Abstract
</summary>
<p>Background
Steroid hormones (i.e., estradiol, progesterone, and testosterone) are considered to play a crucial role in the regulation of women’s sexual desire and sexual attraction to sexual stimuli throughout the menstrual cycle. However, the literature is inconsistent, and methodologically sound studies on the relationship between steroid hormones and women’s sexual attraction are rare.</p>
<p>Methods:
This prospective longitudinal multisite study examined estradiol, progesterone, and testosterone serum levels in association with sexual attraction to visual sexual stimuli in naturally cycling women and in women undergoing fertility treatment (in vitro fertilization, IVF). Across ovarian stimulation of fertility treatment, estradiol reaches supraphysiological levels, while other ovarian hormones remain nearly stable. Ovarian stimulation hence offers a unique quasi-experimental model to study concentration-dependent effects of estradiol. Hormonal parameters and sexual attraction to visual sexual stimuli assessed with computerized visual analogue scales were collected at four time points per cycle, i.e., during the menstrual, preovulatory, mid-luteal, and premenstrual phases, across two consecutive menstrual cycles (n = 88 and n = 68 for the first and second cycle, respectively). Women undergoing fertility treatment (n = 44) were assessed twice, at the beginning and at the end of ovarian stimulation. Sexually explicit photographs served as visual sexual stimuli.</p>
<p>Results
In naturally cycling women, sexual attraction to visual sexual stimuli did not vary consistently across two consecutive menstrual cycles. While in the first menstrual cycle sexual attraction to male bodies, couples kissing, and at intercourse varied significantly with a peak in the preovulatory phase, (all p ≤ 0.001), there was no significant variability across the second cycle. Univariable and multivariable models evaluating repeated cross-sectional relationships and intraindividual change scores revealed no consistent associations between estradiol, progesterone, and testosterone and sexual attraction to visual sexual stimuli throughout both menstrual cycles. Also, no significant association with any hormone was found when the data from both menstrual cycles were combined. In women undergoing ovarian stimulation of IVF, sexual attraction to visual sexual stimuli did not vary over time and was not associated with estradiol levels despite intraindividual changes in estradiol levels from 122.0 to 11,746.0 pmol/l with a mean (SD) of 3,553.9 (2,472.4) pmol/l.</p>
<p>Conclusions
These results imply that neither physiological levels of estradiol, progesterone, and testosterone in naturally cycling women nor supraphysiological levels of estradiol due to ovarian stimulation exert any relevant effect on women’s sexual attraction to visual sexual stimuli.</p>
</details>
<p>The paper caught my attention for two reasons:</p>
<ol type="1">
<li>it’s well-done, interesting work, including serum hormones and both a naturally cycling sample as well as a sample of women undergoing ovarian hyperstimulation in preparation for in vitro fertilisation</li>
<li>they openly shared their data, which I love to see<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</li>
</ol>
<p>So, naturally, I delved right in.</p>
<h2 id="accuracy-of-our-estradiol-and-progesterone-imputations">Accuracy of our estradiol and progesterone imputations</h2>
<p>Almost the first thing I wanted to do was to check the accuracy of our imputations for estradiol and progesterone. In our <a href="https://psyarxiv.com/5r8mg/">recent paper</a>, we had computed the accuracy of imputing log estradiol and progesterone from menstrual cycle phase. However, because we only had raw data for one serum dataset, we used a statistical approach (approximative LOO) to reduce overfitting. One reviewer was skeptical that we would find such good performance in independent data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>o_ests</span> <span class='op'>&lt;-</span> <span class='fu'>broom</span><span class='fu'>::</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='va'>cycles_longer</span><span class='op'>$</span><span class='va'>est_estradiol_fc</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>cycles_longer</span><span class='op'>$</span><span class='va'>OESTR</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p_ests</span> <span class='op'>&lt;-</span> <span class='fu'>broom</span><span class='fu'>::</span><span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span><span class='op'>(</span><span class='va'>cycles_longer</span><span class='op'>$</span><span class='va'>est_progesterone_fc</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>cycles_longer</span><span class='op'>$</span><span class='va'>PROG</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
<p>So, I merged my imputed estradiol and progesterone values on their “time” variable, which, I thought, can be understood as a cycle day counted forward from the last menstrual onset.</p>
<figure>
<img src="https://ars.els-cdn.com/content/image/1-s2.0-S0306453023000380-gr1.jpg" alt="their sampling schedule" />
<figcaption aria-hidden="true">their sampling schedule</figcaption>
</figure>
<p>In the BioCycle study data, I had found the accuracy to be 0.57 [0.55;0.59]. Here, it was 0.68 [0.64;0.72]. For progesterone, we had reported 0.72 [0.70;0.74] and here I got 0.79 [0.76;0.82].</p>
<p>The values here are actually better! They are more in line with our accuracy estimates for backward-counting (.68 &amp; .83). This might be because they do not have strictly days since last menstrual onset here, but rather I back-translated that from their graph of time points. In actual fact, they used some smart scheduling techniques based on LH and sonography. Another difference might be the variance in cycle phase, which they maximized with two measurement occasions close to menstruation, one around ovulation, and one mid-luteal occasion. I could adjust for that, but for now, I mainly take the message that our imputations seem to work pretty well on independent data.</p>
<h2 id="slightly-different-analyses">Slightly different analyses</h2>
<p>Reading the paper, I couldn’t help wonder whether slightly different analysis choices would have led to different results. They used generalized estimating equations and it all seemed well-done if slightly different than what I normally do. But from my own experience with this kind of data (mostly unpublished), I’ve come to the conclusion that:</p>
<ul>
<li>logging steroid hormone concentrations is slightly better than not doing so because
<ul>
<li>not logging you have to make arbitrary decisions how to deal with influential ‘outliers’ which are, however, still bioplausible</li>
<li>there is some evidence that associations are linear after logging</li>
<li>explained variance by cycle phase was slightly bigger in my <a href="https://psyarxiv.com/5r8mg/">recent paper</a></li>
<li>interactions between E and P, or their ratio E/P naturally turn into additive (or rather subtractive) terms after logging, reducing model complexity</li>
</ul></li>
<li>that the relationship between steroid hormones and sexual desire is best predicted by log(estradiol/progesterone)</li>
<li>there is <a href="https://www.sciencedirect.com/science/article/pii/S0018506X13000482">some evidence</a> that the effect of serum log(estradiol/progesterone) is strongest at a lag of around two days on psychological outcomes, but much of that is based on salivary immunoassays, which I don’t put much stock in</li>
<li>that it might be better to leave log(testosterone) out of the equation at first, because it’s plausibly a mediator</li>
<li>I figured I could probably aggregate across their four outcomes (ratings of stimuli of male faces, bodies, kissing, intercourse).</li>
<li>I figured their might be substantial heterogeneity in residual variances, as that’s been my experience with visual analogue rating scales</li>
</ul>
<h3 id="multilevel-generalizability">Multilevel generalizability</h3>
<p>To determine whether I could aggregate across their four outcomes, I ran a multilevel generalizability analysis. I brought their visual analogue scales from 0 to 100 to approximate unit variance by subtracting 50 and dividing by 20.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>cycle_time <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>cycle</span>, <span class='va'>time</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle_time</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"SR_"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.data.frame</span></span>
<span><span class='fu'>psych</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/multilevel.reliability.html'>mlr</a></span><span class='op'>(</span><span class='va'>df</span>, grp <span class='op'>=</span> <span class='st'>"ID"</span>, Time <span class='op'>=</span> <span class='st'>"cycle_time"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>
Multilevel Generalizability analysis   
Call: psych::mlr(x = df, grp = &quot;ID&quot;, Time = &quot;cycle_time&quot;)

The data had  88  observations taken over  8  time intervals for  3 items.

 Alternative estimates of reliability based upon Generalizability theory

RkF  =  0.98 Reliability of average of all ratings across all items and  times (Fixed time effects)
R1R  =  0.75 Generalizability of a single time point across all items (Random time effects)
RkR  =  0.96 Generalizability of average time points across all items (Random time effects)
Rc   =  0.41 Generalizability of change (fixed time points, fixed items) 
RkRn =  0.92 Generalizability of between person differences averaged over time (time nested within people)
Rcn  =  0 Generalizability of within person variations averaged over items  (time nested within people)

 These reliabilities are derived from the components of variance estimated by ANOVA 
             variance Percent
ID               0.25    0.20
Time             0.00    0.00
Items            0.30    0.24
ID x time        0.05    0.04
ID x items       0.41    0.33
time x items     0.00    0.00
Residual         0.22    0.18
Total            1.24    1.00

 The nested components of variance estimated from lme are:
         variance Percent
id        4.3e-01 3.2e-01
id(time)  1.1e-09 8.4e-10
residual  8.9e-01 6.8e-01
total     1.3e+00 1.0e+00

To see the ANOVA and alpha by subject, use the short = FALSE option.
 To see the summaries of the ICCs by subject and time, use all=TRUE
 To see specific objects select from the following list:
 ANOVA s.lmer s.lme alpha summary.by.person summary.by.time ICC.by.person ICC.by.time lmer long Call</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle_time</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"SR_"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle_time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span><span class='va'>cycle_time</span> <span class='op'>~</span> <span class='va'>name</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-4-1.png" alt="Distributions of the outcome visual analogue scale ratings over time. (Z=cycle, T=time point)" width="768" />
<p class="caption">
Figure 1: Distributions of the outcome visual analogue scale ratings over time. (Z=cycle, T=time point)
</p>
</div>
</div>
<p>Hmm, the <em>generalizability of within person variations averaged over items</em> is zero, so maybe aggregating is not a good idea. However, a multivariate model would allow me to do some partial pooling across outcomes, so went with that.</p>
<h3 id="a-multivariate-model">A multivariate model</h3>
<p>So, in the below model, I:</p>
<ul>
<li>logged estradiol and progesterone, this way I did not have to include the estradiol-progesterone ratio in the model</li>
<li>omitted testosterone, at least as a first step</li>
<li>allowed slopes to vary by person and cycle</li>
<li>allowed correlations across outcomes, both for the residuals and the varying slopes and intercepts</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/paul-buerkner/brms'>brms</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mc-stan.org/cmdstanr/'>cmdstanr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mjskay.github.io/tidybayes/'>tidybayes</a></span><span class='op'>)</span></span>
<span><span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>tidy <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>brms.backend <span class='op'>=</span> <span class='st'>"cmdstanr"</span>,  <span class='co'># I use the cmdstanr backend</span></span>
<span>        mc.cores <span class='op'>=</span> <span class='fl'>8</span>, </span>
<span>        brms.threads <span class='op'>=</span> <span class='fl'>2</span>,           <span class='co'># which allows me to multithread</span></span>
<span>        brms.file_refit <span class='op'>=</span> <span class='st'>"on_change"</span>, <span class='co'># this is useful when doing iterative model building, though it can misfire, be careful</span></span>
<span>        width <span class='op'>=</span> <span class='fl'>8000</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>m1mv0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/mvbind.html'>mvbind</a></span><span class='op'>(</span><span class='va'>SR_Faces</span>, <span class='va'>SR_Bodies</span>, <span class='va'>SR_Kissing</span>, <span class='va'>SR_Intercourse</span><span class='op'>)</span> <span class='op'>~</span>  <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span><span class='va'>c</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='va'>logOESTR</span>, <span class='va'>logPROG</span><span class='op'>)</span>,</span>
<span>            iter <span class='op'>=</span> <span class='fl'>6000</span>, file <span class='op'>=</span> <span class='st'>"m1mv0"</span>,</span>
<span>            control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.99</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>m1mv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/mvbind.html'>mvbind</a></span><span class='op'>(</span><span class='va'>SR_Faces</span>, <span class='va'>SR_Bodies</span>, <span class='va'>SR_Kissing</span>, <span class='va'>SR_Intercourse</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>OESTR</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROG</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>OESTR</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROG</span><span class='op'>)</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>OESTR</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>PROG</span><span class='op'>)</span><span class='op'>|</span><span class='va'>c</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>:</span><span class='va'>cycle</span><span class='op'>)</span>, <span class='va'>cycles_long</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>6000</span>, file <span class='op'>=</span> <span class='st'>"m1mv"</span>,</span>
<span>            control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.99</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
<details>
<summary>
Model output and comparison to null model
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>8000</span><span class='op'>)</span></span>
<span><span class='va'>m1mv</span></span></code></pre>
</div>
</details>
<pre><code> Family: MV(gaussian, gaussian, gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: SR_Faces ~ log(OESTR) + log(PROG) + cycle + (1 + log(OESTR) + log(PROG) | i | ID) + (1 + log(OESTR) + log(PROG) | c | ID:cycle) 
         SR_Bodies ~ log(OESTR) + log(PROG) + cycle + (1 + log(OESTR) + log(PROG) | i | ID) + (1 + log(OESTR) + log(PROG) | c | ID:cycle) 
         SR_Kissing ~ log(OESTR) + log(PROG) + cycle + (1 + log(OESTR) + log(PROG) | i | ID) + (1 + log(OESTR) + log(PROG) | c | ID:cycle) 
         SR_Intercourse ~ log(OESTR) + log(PROG) + cycle + (1 + log(OESTR) + log(PROG) | i | ID) + (1 + log(OESTR) + log(PROG) | c | ID:cycle) 
   Data: cycles_long (Number of observations: 551) 
  Draws: 4 chains, each with iter = 6000; warmup = 3000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 87) 
                                                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(SRFaces_Intercept)                                   0.91      0.18     0.52     1.24 1.00     1754      954
sd(SRFaces_logOESTR)                                    0.09      0.05     0.01     0.18 1.01      384     1451
sd(SRFaces_logPROG)                                     0.06      0.03     0.01     0.12 1.00     1262     1162
sd(SRBodies_Intercept)                                  0.71      0.09     0.52     0.89 1.00     3926     3637
sd(SRBodies_logOESTR)                                   0.03      0.02     0.00     0.09 1.01      802     1388
sd(SRBodies_logPROG)                                    0.03      0.02     0.00     0.07 1.00     2272     4007
sd(SRKissing_Intercept)                                 0.80      0.11     0.60     1.05 1.00     5869     6772
sd(SRKissing_logOESTR)                                  0.05      0.03     0.00     0.12 1.00     1228     3401
sd(SRKissing_logPROG)                                   0.03      0.02     0.00     0.07 1.00     2925     5597
sd(SRIntercourse_Intercept)                             0.69      0.14     0.39     0.97 1.00     4201     4153
sd(SRIntercourse_logOESTR)                              0.08      0.03     0.01     0.14 1.01     1482     2455
sd(SRIntercourse_logPROG)                               0.02      0.01     0.00     0.05 1.00     7089     5680
cor(SRFaces_Intercept,SRFaces_logOESTR)                -0.07      0.27    -0.57     0.47 1.00     2049     5232
cor(SRFaces_Intercept,SRFaces_logPROG)                  0.06      0.24    -0.44     0.52 1.00     2412     6102
cor(SRFaces_logOESTR,SRFaces_logPROG)                   0.10      0.27    -0.43     0.59 1.00     2919     5583
cor(SRFaces_Intercept,SRBodies_Intercept)               0.36      0.16     0.00     0.64 1.00     1142     2225
cor(SRFaces_logOESTR,SRBodies_Intercept)                0.15      0.24    -0.35     0.59 1.00      876     1793
cor(SRFaces_logPROG,SRBodies_Intercept)                 0.17      0.23    -0.30     0.59 1.00     1093     2287
cor(SRFaces_Intercept,SRBodies_logOESTR)                0.01      0.26    -0.50     0.51 1.00    12488     9042
cor(SRFaces_logOESTR,SRBodies_logOESTR)                 0.02      0.27    -0.49     0.54 1.00     5779     8230
cor(SRFaces_logPROG,SRBodies_logOESTR)                  0.00      0.27    -0.53     0.53 1.00     8097     8997
cor(SRBodies_Intercept,SRBodies_logOESTR)              -0.01      0.27    -0.51     0.51 1.00     8516     9109
cor(SRFaces_Intercept,SRBodies_logPROG)                 0.03      0.25    -0.46     0.51 1.00    11937     9061
cor(SRFaces_logOESTR,SRBodies_logPROG)                 -0.02      0.27    -0.53     0.51 1.00     6642     8450
cor(SRFaces_logPROG,SRBodies_logPROG)                   0.02      0.27    -0.50     0.54 1.00     7737     8150
cor(SRBodies_Intercept,SRBodies_logPROG)                0.10      0.25    -0.40     0.56 1.00    12621     8147
cor(SRBodies_logOESTR,SRBodies_logPROG)                 0.02      0.27    -0.51     0.54 1.00     6623     8980
cor(SRFaces_Intercept,SRKissing_Intercept)              0.40      0.16     0.05     0.67 1.00     1375     1418
cor(SRFaces_logOESTR,SRKissing_Intercept)               0.11      0.24    -0.39     0.56 1.01     1090     1814
cor(SRFaces_logPROG,SRKissing_Intercept)               -0.17      0.23    -0.59     0.31 1.00     1347     1555
cor(SRBodies_Intercept,SRKissing_Intercept)             0.19      0.16    -0.14     0.46 1.00     3093     5296
cor(SRBodies_logOESTR,SRKissing_Intercept)              0.06      0.26    -0.45     0.54 1.00     1436     3259
cor(SRBodies_logPROG,SRKissing_Intercept)               0.13      0.24    -0.38     0.58 1.00     2175     4124
cor(SRFaces_Intercept,SRKissing_logOESTR)              -0.03      0.26    -0.53     0.48 1.00     6664     8724
cor(SRFaces_logOESTR,SRKissing_logOESTR)               -0.08      0.27    -0.57     0.46 1.00     4768     7422
cor(SRFaces_logPROG,SRKissing_logOESTR)                -0.08      0.27    -0.57     0.45 1.00     5973     8418
cor(SRBodies_Intercept,SRKissing_logOESTR)              0.15      0.26    -0.38     0.61 1.00    10292     8256
cor(SRBodies_logOESTR,SRKissing_logOESTR)               0.07      0.27    -0.47     0.58 1.00     7156     8895
cor(SRBodies_logPROG,SRKissing_logOESTR)                0.06      0.27    -0.49     0.57 1.00     8805     9999
cor(SRKissing_Intercept,SRKissing_logOESTR)            -0.18      0.28    -0.66     0.40 1.00     4508     8079
cor(SRFaces_Intercept,SRKissing_logPROG)               -0.07      0.26    -0.54     0.45 1.00    13308     8995
cor(SRFaces_logOESTR,SRKissing_logPROG)                -0.03      0.27    -0.54     0.51 1.00     8504     9278
cor(SRFaces_logPROG,SRKissing_logPROG)                  0.04      0.27    -0.50     0.55 1.00     9818     8006
cor(SRBodies_Intercept,SRKissing_logPROG)              -0.00      0.26    -0.49     0.50 1.00    14921     8442
cor(SRBodies_logOESTR,SRKissing_logPROG)               -0.01      0.27    -0.52     0.51 1.00     7387     8837
cor(SRBodies_logPROG,SRKissing_logPROG)                 0.02      0.27    -0.50     0.54 1.00     8177     9815
cor(SRKissing_Intercept,SRKissing_logPROG)             -0.05      0.26    -0.53     0.47 1.00    13370     9196
cor(SRKissing_logOESTR,SRKissing_logPROG)              -0.00      0.27    -0.52     0.53 1.00     7398     9032
cor(SRFaces_Intercept,SRIntercourse_Intercept)          0.02      0.20    -0.36     0.40 1.00     2583     4005
cor(SRFaces_logOESTR,SRIntercourse_Intercept)          -0.03      0.24    -0.51     0.44 1.00     1166     2638
cor(SRFaces_logPROG,SRIntercourse_Intercept)           -0.05      0.24    -0.52     0.41 1.00     1573     3470
cor(SRBodies_Intercept,SRIntercourse_Intercept)         0.21      0.17    -0.15     0.53 1.00     5264     7247
cor(SRBodies_logOESTR,SRIntercourse_Intercept)          0.05      0.26    -0.45     0.54 1.00     1664     3815
cor(SRBodies_logPROG,SRIntercourse_Intercept)           0.16      0.25    -0.36     0.61 1.00     2143     3525
cor(SRKissing_Intercept,SRIntercourse_Intercept)        0.46      0.19     0.03     0.75 1.00     2193     5048
cor(SRKissing_logOESTR,SRIntercourse_Intercept)         0.19      0.26    -0.35     0.66 1.00     2642     6558
cor(SRKissing_logPROG,SRIntercourse_Intercept)          0.13      0.26    -0.40     0.60 1.00     3781     7742
cor(SRFaces_Intercept,SRIntercourse_logOESTR)           0.12      0.23    -0.34     0.54 1.00     4581     6479
cor(SRFaces_logOESTR,SRIntercourse_logOESTR)            0.07      0.26    -0.44     0.57 1.00     2286     5319
cor(SRFaces_logPROG,SRIntercourse_logOESTR)             0.01      0.25    -0.48     0.50 1.00     3672     7120
cor(SRBodies_Intercept,SRIntercourse_logOESTR)         -0.05      0.22    -0.48     0.39 1.00     9113     7600
cor(SRBodies_logOESTR,SRIntercourse_logOESTR)          -0.04      0.27    -0.55     0.49 1.00     2956     6047
cor(SRBodies_logPROG,SRIntercourse_logOESTR)            0.10      0.26    -0.44     0.59 1.00     3664     6303
cor(SRKissing_Intercept,SRIntercourse_logOESTR)         0.29      0.23    -0.21     0.68 1.00     7440     5910
cor(SRKissing_logOESTR,SRIntercourse_logOESTR)          0.02      0.27    -0.51     0.54 1.00     4481     7853
cor(SRKissing_logPROG,SRIntercourse_logOESTR)           0.07      0.27    -0.46     0.58 1.00     5425     9041
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR)    -0.09      0.27    -0.58     0.46 1.00     4465     7950
cor(SRFaces_Intercept,SRIntercourse_logPROG)           -0.04      0.28    -0.56     0.50 1.00    19037     8436
cor(SRFaces_logOESTR,SRIntercourse_logPROG)            -0.01      0.27    -0.53     0.51 1.00    16186     8912
cor(SRFaces_logPROG,SRIntercourse_logPROG)             -0.00      0.28    -0.53     0.53 1.00    14895     8501
cor(SRBodies_Intercept,SRIntercourse_logPROG)          -0.03      0.28    -0.55     0.50 1.00    20543     8788
cor(SRBodies_logOESTR,SRIntercourse_logPROG)            0.00      0.28    -0.54     0.54 1.00    10941     8990
cor(SRBodies_logPROG,SRIntercourse_logPROG)            -0.00      0.28    -0.55     0.53 1.00    11439     9846
cor(SRKissing_Intercept,SRIntercourse_logPROG)         -0.01      0.27    -0.54     0.50 1.00    16414     9556
cor(SRKissing_logOESTR,SRIntercourse_logPROG)           0.01      0.28    -0.53     0.54 1.00     9671     9039
cor(SRKissing_logPROG,SRIntercourse_logPROG)            0.04      0.28    -0.51     0.57 1.00     8979    10350
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)     -0.01      0.27    -0.53     0.53 1.00    13612    10073
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)      -0.04      0.27    -0.55     0.50 1.00    10481    10230

~ID:cycle (Number of levels: 155) 
                                                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(SRFaces_Intercept)                                   0.23      0.14     0.01     0.49 1.00     1060     3003
sd(SRFaces_logOESTR)                                    0.05      0.02     0.01     0.09 1.01      755     1774
sd(SRFaces_logPROG)                                     0.04      0.03     0.00     0.09 1.00     2833     5791
sd(SRBodies_Intercept)                                  0.20      0.08     0.02     0.34 1.00     1123     1537
sd(SRBodies_logOESTR)                                   0.02      0.01     0.00     0.05 1.00      676     2430
sd(SRBodies_logPROG)                                    0.03      0.02     0.00     0.07 1.00     1976     5255
sd(SRKissing_Intercept)                                 0.11      0.07     0.01     0.25 1.00     2373     4992
sd(SRKissing_logOESTR)                                  0.02      0.01     0.00     0.05 1.00     1464     3148
sd(SRKissing_logPROG)                                   0.02      0.02     0.00     0.06 1.00     4545     6123
sd(SRIntercourse_Intercept)                             0.14      0.08     0.01     0.28 1.00     2539     4014
sd(SRIntercourse_logOESTR)                              0.02      0.01     0.00     0.04 1.00     2537     5787
sd(SRIntercourse_logPROG)                               0.02      0.02     0.00     0.06 1.00     4235     5040
cor(SRFaces_Intercept,SRFaces_logOESTR)                -0.06      0.28    -0.60     0.49 1.00     3019     6296
cor(SRFaces_Intercept,SRFaces_logPROG)                 -0.03      0.28    -0.55     0.50 1.00    11293     8423
cor(SRFaces_logOESTR,SRFaces_logPROG)                  -0.01      0.27    -0.53     0.51 1.00    12835     8356
cor(SRFaces_Intercept,SRBodies_Intercept)               0.09      0.27    -0.46     0.56 1.00     2221     4411
cor(SRFaces_logOESTR,SRBodies_Intercept)                0.10      0.25    -0.42     0.55 1.00     2766     5243
cor(SRFaces_logPROG,SRBodies_Intercept)                 0.10      0.27    -0.45     0.60 1.00     2287     4660
cor(SRFaces_Intercept,SRBodies_logOESTR)                0.04      0.27    -0.50     0.55 1.00     5202     7342
cor(SRFaces_logOESTR,SRBodies_logOESTR)                 0.06      0.27    -0.49     0.55 1.00     5287     6875
cor(SRFaces_logPROG,SRBodies_logOESTR)                  0.06      0.27    -0.49     0.58 1.00     3829     6984
cor(SRBodies_Intercept,SRBodies_logOESTR)              -0.04      0.28    -0.59     0.51 1.00     8507     6344
cor(SRFaces_Intercept,SRBodies_logPROG)                -0.02      0.27    -0.55     0.50 1.00     8783     8879
cor(SRFaces_logOESTR,SRBodies_logPROG)                 -0.04      0.27    -0.55     0.49 1.00     9136     9456
cor(SRFaces_logPROG,SRBodies_logPROG)                  -0.02      0.28    -0.54     0.52 1.00     8549     9224
cor(SRBodies_Intercept,SRBodies_logPROG)               -0.20      0.29    -0.69     0.41 1.00     3898     7763
cor(SRBodies_logOESTR,SRBodies_logPROG)                -0.11      0.29    -0.63     0.46 1.00     5296     8147
cor(SRFaces_Intercept,SRKissing_Intercept)              0.03      0.27    -0.50     0.55 1.00     7627     8351
cor(SRFaces_logOESTR,SRKissing_Intercept)               0.04      0.27    -0.49     0.54 1.00     9729     8352
cor(SRFaces_logPROG,SRKissing_Intercept)               -0.02      0.27    -0.54     0.51 1.00     7009     7496
cor(SRBodies_Intercept,SRKissing_Intercept)             0.04      0.27    -0.49     0.54 1.00     8606     9138
cor(SRBodies_logOESTR,SRKissing_Intercept)              0.04      0.27    -0.50     0.56 1.00     6706     9178
cor(SRBodies_logPROG,SRKissing_Intercept)              -0.01      0.28    -0.55     0.53 1.00     7502     9014
cor(SRFaces_Intercept,SRKissing_logOESTR)               0.03      0.26    -0.49     0.53 1.00     4404     7148
cor(SRFaces_logOESTR,SRKissing_logOESTR)                0.02      0.26    -0.49     0.50 1.00     6463     7900
cor(SRFaces_logPROG,SRKissing_logOESTR)                -0.04      0.28    -0.56     0.50 1.00     4373     7109
cor(SRBodies_Intercept,SRKissing_logOESTR)              0.04      0.26    -0.47     0.53 1.00     7013     9063
cor(SRBodies_logOESTR,SRKissing_logOESTR)               0.04      0.27    -0.49     0.55 1.00     5720     8204
cor(SRBodies_logPROG,SRKissing_logOESTR)               -0.01      0.27    -0.54     0.51 1.00     5952     7872
cor(SRKissing_Intercept,SRKissing_logOESTR)            -0.05      0.28    -0.58     0.50 1.00     6173     8371
cor(SRFaces_Intercept,SRKissing_logPROG)                0.04      0.27    -0.49     0.55 1.00    12145     9111
cor(SRFaces_logOESTR,SRKissing_logPROG)                 0.06      0.28    -0.48     0.58 1.00    13327     9312
cor(SRFaces_logPROG,SRKissing_logPROG)                  0.02      0.27    -0.51     0.54 1.00    12235     9822
cor(SRBodies_Intercept,SRKissing_logPROG)               0.02      0.27    -0.51     0.53 1.00    12509     9268
cor(SRBodies_logOESTR,SRKissing_logPROG)                0.01      0.28    -0.52     0.54 1.00    10632     9904
cor(SRBodies_logPROG,SRKissing_logPROG)                -0.04      0.28    -0.56     0.51 1.00     9590     9562
cor(SRKissing_Intercept,SRKissing_logPROG)             -0.02      0.28    -0.56     0.53 1.00    10356    10061
cor(SRKissing_logOESTR,SRKissing_logPROG)              -0.03      0.28    -0.56     0.51 1.00     9963     9191
cor(SRFaces_Intercept,SRIntercourse_Intercept)         -0.07      0.27    -0.58     0.47 1.00     5145     7140
cor(SRFaces_logOESTR,SRIntercourse_Intercept)          -0.08      0.26    -0.56     0.44 1.00     6862     8269
cor(SRFaces_logPROG,SRIntercourse_Intercept)           -0.05      0.27    -0.56     0.50 1.00     5857     7855
cor(SRBodies_Intercept,SRIntercourse_Intercept)        -0.09      0.26    -0.56     0.45 1.00     5792     5964
cor(SRBodies_logOESTR,SRIntercourse_Intercept)         -0.06      0.27    -0.57     0.49 1.00     6194     8864
cor(SRBodies_logPROG,SRIntercourse_Intercept)           0.07      0.28    -0.48     0.58 1.00     6205     8620
cor(SRKissing_Intercept,SRIntercourse_Intercept)        0.09      0.28    -0.46     0.59 1.00     6045     9092
cor(SRKissing_logOESTR,SRIntercourse_Intercept)         0.15      0.28    -0.42     0.65 1.00     5312     7865
cor(SRKissing_logPROG,SRIntercourse_Intercept)         -0.00      0.27    -0.52     0.52 1.00     7463    10084
cor(SRFaces_Intercept,SRIntercourse_logOESTR)          -0.02      0.27    -0.54     0.51 1.00     8691     8116
cor(SRFaces_logOESTR,SRIntercourse_logOESTR)           -0.01      0.26    -0.51     0.50 1.00     9421     9011
cor(SRFaces_logPROG,SRIntercourse_logOESTR)            -0.04      0.27    -0.55     0.50 1.00     7492     8835
cor(SRBodies_Intercept,SRIntercourse_logOESTR)         -0.08      0.27    -0.58     0.47 1.00     7262     8595
cor(SRBodies_logOESTR,SRIntercourse_logOESTR)          -0.06      0.27    -0.57     0.49 1.00     6478     8494
cor(SRBodies_logPROG,SRIntercourse_logOESTR)            0.06      0.28    -0.49     0.57 1.00     7140     8383
cor(SRKissing_Intercept,SRIntercourse_logOESTR)         0.07      0.28    -0.49     0.59 1.00     6995     9369
cor(SRKissing_logOESTR,SRIntercourse_logOESTR)          0.11      0.28    -0.46     0.62 1.00     6502     9009
cor(SRKissing_logPROG,SRIntercourse_logOESTR)          -0.00      0.28    -0.54     0.53 1.00     7081     9351
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR)    -0.06      0.28    -0.60     0.48 1.00     9499     9733
cor(SRFaces_Intercept,SRIntercourse_logPROG)           -0.00      0.27    -0.53     0.52 1.00    14990     9485
cor(SRFaces_logOESTR,SRIntercourse_logPROG)             0.01      0.27    -0.51     0.53 1.00    14252     9014
cor(SRFaces_logPROG,SRIntercourse_logPROG)              0.00      0.28    -0.52     0.54 1.00    12405     8696
cor(SRBodies_Intercept,SRIntercourse_logPROG)          -0.03      0.27    -0.56     0.50 1.00    13054     9155
cor(SRBodies_logOESTR,SRIntercourse_logPROG)           -0.02      0.28    -0.55     0.52 1.00    10884     9401
cor(SRBodies_logPROG,SRIntercourse_logPROG)             0.03      0.28    -0.52     0.56 1.00    10002     9051
cor(SRKissing_Intercept,SRIntercourse_logPROG)          0.03      0.28    -0.51     0.55 1.00    10663    10129
cor(SRKissing_logOESTR,SRIntercourse_logPROG)           0.04      0.28    -0.50     0.56 1.00    10282    10091
cor(SRKissing_logPROG,SRIntercourse_logPROG)            0.03      0.28    -0.50     0.56 1.00     8733     9824
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)     -0.03      0.27    -0.54     0.50 1.00     9800    10886
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)      -0.01      0.28    -0.54     0.53 1.00     8420    10232

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
SRFaces_Intercept          -0.04      0.24    -0.51     0.44 1.00     9371     9434
SRBodies_Intercept         -0.79      0.15    -1.09    -0.49 1.00     9116     9399
SRKissing_Intercept         0.10      0.19    -0.27     0.48 1.00     9851     9558
SRIntercourse_Intercept     0.22      0.20    -0.17     0.60 1.00    10865     9431
SRFaces_logOESTR           -0.01      0.04    -0.09     0.07 1.00    11608     9730
SRFaces_logPROG            -0.02      0.02    -0.06     0.03 1.00    12397    10268
SRFaces_cycleZ2            -0.15      0.09    -0.32     0.03 1.00     8394     9534
SRBodies_logOESTR           0.02      0.02    -0.02     0.07 1.00    13214     9353
SRBodies_logPROG           -0.03      0.01    -0.06    -0.00 1.00    12169     9525
SRBodies_cycleZ2           -0.15      0.05    -0.25    -0.05 1.00     9394     9186
SRKissing_logOESTR          0.07      0.03     0.01     0.13 1.00    11914    10016
SRKissing_logPROG          -0.03      0.02    -0.06     0.00 1.00    11387     9710
SRKissing_cycleZ2           0.05      0.05    -0.05     0.16 1.00    10076     9242
SRIntercourse_logOESTR      0.10      0.03     0.03     0.16 1.00    10294     8333
SRIntercourse_logPROG      -0.03      0.02    -0.07    -0.00 1.00    11949     9636
SRIntercourse_cycleZ2       0.00      0.06    -0.10     0.12 1.00    11584     9844

Family Specific Parameters: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_SRFaces           0.60      0.02     0.55     0.64 1.00     6182     9029
sigma_SRBodies          0.35      0.01     0.33     0.38 1.00     5629     8346
sigma_SRKissing         0.46      0.02     0.43     0.50 1.00     6691     8625
sigma_SRIntercourse     0.49      0.02     0.46     0.53 1.00     7790     8743

Residual Correlations: 
                                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
rescor(SRFaces,SRBodies)            0.30      0.05     0.20     0.39 1.00     9539     9467
rescor(SRFaces,SRKissing)           0.15      0.05     0.05     0.25 1.00     8908     8678
rescor(SRBodies,SRKissing)          0.18      0.05     0.08     0.27 1.00     9600     9746
rescor(SRFaces,SRIntercourse)       0.09      0.05    -0.01     0.19 1.00    10994     9227
rescor(SRBodies,SRIntercourse)      0.14      0.05     0.04     0.24 1.00    10321     8966
rescor(SRKissing,SRIntercourse)     0.48      0.04     0.40     0.55 1.00     8200     9036

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/loo.brmsfit.html'>LOO</a></span><span class='op'>(</span><span class='va'>m1mv0</span>, <span class='va'>m1mv</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>Output of model &#39;m1mv0&#39;:

Computed from 12000 by 551 log-likelihood matrix

         Estimate    SE
elpd_loo  -1662.1  53.8
p_loo       432.1  19.4
looic      3324.1 107.6
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     431   78.2%   405       
 (0.5, 0.7]   (ok)       102   18.5%   116       
   (0.7, 1]   (bad)       16    2.9%   31        
   (1, Inf)   (very bad)   2    0.4%   9         
See help(&#39;pareto-k-diagnostic&#39;) for details.

Output of model &#39;m1mv&#39;:

Computed from 12000 by 551 log-likelihood matrix

         Estimate    SE
elpd_loo  -1651.4  53.5
p_loo       509.6  21.8
looic      3302.8 107.0
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)     325   59.0%   777       
 (0.5, 0.7]   (ok)       183   33.2%   204       
   (0.7, 1]   (bad)       39    7.1%   31        
   (1, Inf)   (very bad)   4    0.7%   13        
See help(&#39;pareto-k-diagnostic&#39;) for details.

Model comparisons:
      elpd_diff se_diff
m1mv    0.0       0.0  
m1mv0 -10.7       7.0  </code></pre>
</div>
</details>
<p>As you can see if you expand the detail above, this doesn’t lead to very different conclusions.</p>
<h3 id="a-location-scale-model">A location-scale model</h3>
<p>So, on analogue rating scales, you often see substantially heterogeneous variances, this is the case here too. Will accounting for it in a simple location-scale model make a difference? From here on out, I’m going to simplify and only look at one outcome (<code>SR_Intercourse</code>) for now. I’ll also drop the varying slopes by cycle for simplicity.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>sds</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle_time</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"SR_"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>cycle_time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>name</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>sds</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>sd</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>sd</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>name</span>, scales <span class='op'>=</span> <span class='st'>"free"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-7-1.png" alt="Heterogenity in standard deviations by person." width="480" />
<p class="caption">
Figure 2: Heterogenity in standard deviations by person.
</p>
</div>
</div>
<details>
<summary>
Model output
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>m1intercourse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span>, <span class='va'>cycles_long</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>4000</span>, file <span class='op'>=</span> <span class='st'>"m1intercourse"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>m1intercourse_sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span>,</span>
<span>                        <span class='va'>sigma</span> <span class='op'>~</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>cycles_long</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>6000</span>, file <span class='op'>=</span> <span class='st'>"m1intercourse_sigma"</span>, </span>
<span>            <span class='co'># file_refit = "always",</span></span>
<span>            control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>.99</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>m1intercourse_sigma</span></span></code></pre>
</div>
</details>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: SR_Intercourse ~ logOESTR + logPROG + cycle + (1 + logOESTR + logPROG | i | ID) 
         sigma ~ (1 | i | ID)
   Data: cycles_long (Number of observations: 551) 
  Draws: 4 chains, each with iter = 6000; warmup = 3000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 87) 
                               Estimate Est.Error l-95% CI u-95% CI
sd(Intercept)                      0.79      0.17     0.46     1.15
sd(logOESTR)                       0.08      0.04     0.01     0.17
sd(logPROG)                        0.02      0.01     0.00     0.05
sd(sigma_Intercept)                0.39      0.06     0.28     0.51
cor(Intercept,logOESTR)           -0.19      0.39    -0.74     0.68
cor(Intercept,logPROG)             0.22      0.41    -0.66     0.86
cor(logOESTR,logPROG)             -0.07      0.44    -0.82     0.77
cor(Intercept,sigma_Intercept)    -0.47      0.21    -0.85    -0.02
cor(logOESTR,sigma_Intercept)      0.14      0.34    -0.57     0.74
cor(logPROG,sigma_Intercept)      -0.23      0.42    -0.88     0.68
                               Rhat Bulk_ESS Tail_ESS
sd(Intercept)                  1.00     3690     4494
sd(logOESTR)                   1.01      417     1162
sd(logPROG)                    1.00     6321     7354
sd(sigma_Intercept)            1.00     4169     7572
cor(Intercept,logOESTR)        1.00     1096     3026
cor(Intercept,logPROG)         1.00    13507     8678
cor(logOESTR,logPROG)          1.00     9315     9202
cor(Intercept,sigma_Intercept) 1.00     1293     2803
cor(logOESTR,sigma_Intercept)  1.00     1043     1323
cor(logPROG,sigma_Intercept)   1.01      637     2282

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept           0.25      0.19    -0.12     0.62 1.00     9289
sigma_Intercept    -0.81      0.06    -0.92    -0.70 1.00     5269
logOESTR            0.09      0.03     0.03     0.15 1.00     9304
logPROG            -0.03      0.02    -0.06    -0.00 1.00     9162
cycleZ2             0.03      0.04    -0.05     0.11 1.00    17403
                Tail_ESS
Intercept           9697
sigma_Intercept     8109
logOESTR            9188
logPROG             9117
cycleZ2             9139

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</details>
<p>Not so!</p>
<h3 id="group-mean-centering">Group mean centering</h3>
<p>So, actually we expect the effects of estradiol and progesterone to happen on the within-person level. Differences in average levels of E and P could actually confound the relationship we’re interested in. Adjusting for this is possible using various methods (this <a href="https://www.youtube.com/watch?v=iwVqiiXYeC4&amp;t=3285s">video</a> gives a great introduction.</p>
<p>We can simply subtract the group mean from logOESTR and logPROG.</p>
<details>
<summary>
Model output
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>logOESTRm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logOESTR</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>                     logPROGm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logPROG</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>logOESTR_gmc <span class='op'>=</span> <span class='va'>logOESTR</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logOESTR</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>                     logPROG_gmc <span class='op'>=</span> <span class='va'>logPROG</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logPROG</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"log"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span>use <span class='op'>=</span> <span class='st'>"pairwise"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>             logOESTR logPROG logOESTRm logPROGm logOESTR_gmc
logOESTR         1.00    0.36      0.39     0.11         0.92
logPROG          0.36    1.00      0.08     0.28         0.36
logOESTRm        0.39    0.08      1.00     0.28         0.00
logPROGm         0.11    0.28      0.28     1.00         0.00
logOESTR_gmc     0.92    0.36      0.00     0.00         1.00
logPROG_gmc      0.35    0.96      0.00     0.00         0.37
             logPROG_gmc
logOESTR            0.35
logPROG             0.96
logOESTRm           0.00
logPROGm            0.00
logOESTR_gmc        0.37
logPROG_gmc         1.00</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>m1intercoursegmc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span>, <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>logOESTR <span class='op'>=</span> <span class='va'>logOESTR</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logOESTR</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>                     logPROG <span class='op'>=</span> <span class='va'>logPROG</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>logPROG</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>4000</span>, file <span class='op'>=</span> <span class='st'>"m1intercoursegmc"</span><span class='op'>)</span></span>
<span><span class='va'>m1intercoursegmc</span></span></code></pre>
</div>
</details>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: SR_Intercourse ~ logOESTR + logPROG + cycle + (1 + logOESTR + logPROG | i | ID) 
   Data: cycles_long %&gt;% group_by(ID) %&gt;% mutate(logOESTR = (Number of observations: 551) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~ID (Number of levels: 87) 
                        Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)               0.81      0.07     0.69     0.95 1.00
sd(logOESTR)                0.07      0.04     0.00     0.17 1.00
sd(logPROG)                 0.02      0.01     0.00     0.05 1.00
cor(Intercept,logOESTR)     0.37      0.37    -0.53     0.92 1.00
cor(Intercept,logPROG)      0.09      0.46    -0.82     0.87 1.00
cor(logOESTR,logPROG)      -0.05      0.50    -0.88     0.87 1.00
                        Bulk_ESS Tail_ESS
sd(Intercept)               1728     3282
sd(logOESTR)                2570     3237
sd(logPROG)                 4973     4970
cor(Intercept,logOESTR)     8913     5207
cor(Intercept,logPROG)     12655     5410
cor(logOESTR,logPROG)       8904     6668

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.74      0.09     0.56     0.92 1.00      945     2056
logOESTR      0.10      0.03     0.03     0.17 1.00    10853     6651
logPROG      -0.03      0.02    -0.07     0.00 1.00    11128     5939
cycleZ2      -0.00      0.05    -0.09     0.09 1.00    12906     6139

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.51      0.02     0.48     0.54 1.00     8185     5933

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</details>
<p>Well, this makes little if any difference, which makes sense considering that there isn’t much between-subject variance in estradiol and progesterone to begin with.</p>
<h3 id="latent-group-mean-centering">Latent group mean centering</h3>
<p>Being a brms lover, I’ve been looking for an excuse to try Matti Vuorre’s implementation of latent group mean centering in brms. So, here goes. <strong>Edit:</strong> I’ve confirmed through more simulations that this approach does not work.</p>
<details>
<summary>
Model output
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>latent_formula</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span></span>
<span>  <span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>intercept</span> <span class='op'>+</span> </span>
<span>    <span class='va'>blogOESTR</span><span class='op'>*</span><span class='op'>(</span><span class='va'>logOESTR</span> <span class='op'>-</span> <span class='va'>logOESTRlm</span><span class='op'>)</span>, <span class='co'># lm = latent mean,</span></span>
<span>  <span class='va'>intercept</span> <span class='op'>+</span> <span class='va'>blogOESTR</span> <span class='op'>+</span> <span class='va'>logOESTRlm</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>  nl <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>gaussian</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/get_prior.html'>get_prior</a></span><span class='op'>(</span><span class='va'>latent_formula</span>, data <span class='op'>=</span> <span class='va'>cycles_long</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    prior <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>class</span> <span class='op'>==</span> <span class='st'>"b"</span> <span class='op'>&amp;</span> <span class='va'>coef</span> <span class='op'>==</span> <span class='st'>"Intercept"</span> <span class='op'>~</span> <span class='st'>"normal(0, 1)"</span>,</span>
<span>      <span class='va'>class</span> <span class='op'>==</span> <span class='st'>"sd"</span> <span class='op'>&amp;</span> <span class='va'>coef</span> <span class='op'>==</span> <span class='st'>"Intercept"</span> <span class='op'>~</span> <span class='st'>"student_t(7, 0, 1)"</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>prior</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='va'>fit_latent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span></span>
<span>  <span class='va'>latent_formula</span>,</span>
<span>  data <span class='op'>=</span> <span class='va'>cycles_long</span>,</span>
<span>  prior <span class='op'>=</span> <span class='va'>p</span>,</span>
<span>  iter <span class='op'>=</span> <span class='fl'>4000</span>,</span>
<span>  cores <span class='op'>=</span> <span class='fl'>8</span>, chains <span class='op'>=</span> <span class='fl'>4</span>, threads <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>  backend <span class='op'>=</span> <span class='st'>"cmdstanr"</span>,</span>
<span>  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.99</span><span class='op'>)</span>,</span>
<span>  file <span class='op'>=</span> <span class='st'>"brm-fit-latent-mean-centered3"</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fit_latent</span></span></code></pre>
</div>
</details>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: SR_Intercourse ~ intercept + blogOESTR * (logOESTR - logOESTRlm) 
         intercept ~ 1 + (1 | ID)
         blogOESTR ~ 1 + (1 | ID)
         logOESTRlm ~ 1 + (1 | ID)
   Data: cycles_long (Number of observations: 562) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~ID (Number of levels: 87) 
                         Estimate Est.Error l-95% CI u-95% CI Rhat
sd(intercept_Intercept)      0.57      0.21     0.07     0.86 1.03
sd(blogOESTR_Intercept)      0.08      0.03     0.01     0.14 1.02
sd(logOESTRlm_Intercept)     1.25      1.30     0.04     5.08 1.02
                         Bulk_ESS Tail_ESS
sd(intercept_Intercept)       255      400
sd(blogOESTR_Intercept)       347     1040
sd(logOESTRlm_Intercept)      224      111

Population-Level Effects: 
                     Estimate Est.Error l-95% CI u-95% CI Rhat
intercept_Intercept      0.36      0.24    -0.09     0.83 1.01
blogOESTR_Intercept      0.06      0.04    -0.01     0.13 1.01
logOESTRlm_Intercept     0.05      1.01    -1.94     2.04 1.00
                     Bulk_ESS Tail_ESS
intercept_Intercept       444      389
blogOESTR_Intercept       748      618
logOESTRlm_Intercept     1151     1038

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.51      0.02     0.48     0.54 1.00     8720     5997

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</details>
<p><strong>Edit:</strong> Here’s an approach that does work.</p>
<details>
<summary>
Model output
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cycles_long</span> <span class='op'>&lt;-</span> <span class='va'>cycles_long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>logOESTR2 <span class='op'>=</span> <span class='va'>logOESTR</span>,</span>
<span>                     seOE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>logOESTR</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>logOESTR</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>                     seP <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>logPROG</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>logOESTR</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>                     logPROG2 <span class='op'>=</span> <span class='va'>logPROG</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fit_latent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span> <span class='op'>+</span> </span>
<span>       <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='va'>logOESTR2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='va'>logPROG2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>logOESTR</span> <span class='op'>+</span> <span class='va'>logPROG</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>logPROG2</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='va'>seP</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>logOESTR2</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='va'>seOE</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula-helpers.html'>set_rescor</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>cycles_long</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>4000</span>, file <span class='op'>=</span> <span class='st'>"m1intercoursegmcmi"</span><span class='op'>)</span></span>
<span><span class='va'>fit_latent</span></span></code></pre>
</div>
</details>
<pre><code> Family: MV(gaussian, gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: SR_Intercourse ~ logOESTR + logPROG + mi(logOESTR2) + mi(logPROG2) + cycle + (1 + logOESTR + logPROG | i | ID) 
         logPROG2 | mi(seP) ~ 1 + (1 | ID) 
         logOESTR2 | mi(seOE) ~ 1 + (1 | ID) 
   Data: cycles_long (Number of observations: 551) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Group-Level Effects: 
~ID (Number of levels: 87) 
                                                    Estimate
sd(SRIntercourse_Intercept)                             0.68
sd(SRIntercourse_logOESTR)                              0.07
sd(SRIntercourse_logPROG)                               0.02
sd(logPROG2_Intercept)                                  0.07
sd(logOESTR2_Intercept)                                 0.08
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR)     0.04
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)      0.06
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)      -0.04
                                                    Est.Error
sd(SRIntercourse_Intercept)                              0.19
sd(SRIntercourse_logOESTR)                               0.04
sd(SRIntercourse_logPROG)                                0.01
sd(logPROG2_Intercept)                                   0.05
sd(logOESTR2_Intercept)                                  0.05
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR)      0.43
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)       0.48
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)        0.49
                                                    l-95% CI u-95% CI
sd(SRIntercourse_Intercept)                             0.28     1.04
sd(SRIntercourse_logOESTR)                              0.01     0.15
sd(SRIntercourse_logPROG)                               0.00     0.05
sd(logPROG2_Intercept)                                  0.00     0.20
sd(logOESTR2_Intercept)                                 0.00     0.19
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR)    -0.69     0.85
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)     -0.84     0.87
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)      -0.88     0.87
                                                    Rhat Bulk_ESS
sd(SRIntercourse_Intercept)                         1.00     1937
sd(SRIntercourse_logOESTR)                          1.02      216
sd(SRIntercourse_logPROG)                           1.00     3806
sd(logPROG2_Intercept)                              1.00     4910
sd(logOESTR2_Intercept)                             1.00     2290
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR) 1.00      947
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)  1.00     8227
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)   1.00     6669
                                                    Tail_ESS
sd(SRIntercourse_Intercept)                             1606
sd(SRIntercourse_logOESTR)                               832
sd(SRIntercourse_logPROG)                               3384
sd(logPROG2_Intercept)                                  3494
sd(logOESTR2_Intercept)                                 2522
cor(SRIntercourse_Intercept,SRIntercourse_logOESTR)     1876
cor(SRIntercourse_Intercept,SRIntercourse_logPROG)      4660
cor(SRIntercourse_logOESTR,SRIntercourse_logPROG)       5849

Population-Level Effects: 
                          Estimate Est.Error l-95% CI u-95% CI Rhat
SRIntercourse_Intercept       0.24      0.21    -0.17     0.65 1.00
logPROG2_Intercept            1.69      0.06     1.57     1.82 1.00
logOESTR2_Intercept           5.86      0.03     5.79     5.92 1.00
SRIntercourse_logOESTR        0.25      0.31    -0.36     0.87 1.00
SRIntercourse_logPROG        -0.07      0.26    -0.58     0.45 1.00
SRIntercourse_cycleZ2        -0.00      0.05    -0.09     0.09 1.00
SRIntercourse_milogOESTR2    -0.15      0.32    -0.80     0.46 1.00
SRIntercourse_milogPROG2      0.04      0.27    -0.50     0.56 1.00
                          Bulk_ESS Tail_ESS
SRIntercourse_Intercept       5048     5438
logPROG2_Intercept           10305     6300
logOESTR2_Intercept          10605     6361
SRIntercourse_logOESTR        1668     2497
SRIntercourse_logPROG          863     1624
SRIntercourse_cycleZ2        11095     5934
SRIntercourse_milogOESTR2     1657     2569
SRIntercourse_milogPROG2       864     1578

Family Specific Parameters: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat
sigma_SRIntercourse     0.50      0.02     0.47     0.54 1.00
sigma_logPROG2          1.43      0.04     1.34     1.52 1.00
sigma_logOESTR2         0.77      0.02     0.73     0.82 1.00
                    Bulk_ESS Tail_ESS
sigma_SRIntercourse     4409     4243
sigma_logPROG2         11362     5936
sigma_logOESTR2        10387     6745

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</details>
<h3 id="imputations-and-lag">Imputations and lag</h3>
<p>To get at the question, whether estradiol and progesterone have time-delayed effects on sexual desire, we would ideally like to have measured serum steroids a few days ahead. Unfortunately, this wasn’t done here (they did measure serum steroids on some other days, but did not share those data).
A simple solution would be to substitute in my imputed hormones for the days two days prior to the rating task.</p>
<details>
<summary>
Model output
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>m1_lagi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>est_estradiol_fc_lag2</span> <span class='op'>+</span> <span class='va'>est_progesterone_fc_lag2</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>est_estradiol_fc_lag2</span> <span class='op'>+</span> <span class='va'>est_progesterone_fc_lag2</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span>, <span class='va'>cycles_longer</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>6000</span>, file <span class='op'>=</span> <span class='st'>"m1mv_lagi"</span>,</span>
<span>            control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.99</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>m1_lagi</span></span></code></pre>
</div>
</details>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: SR_Intercourse ~ est_estradiol_fc_lag2 + est_progesterone_fc_lag2 + cycle + (1 + est_estradiol_fc_lag2 + est_progesterone_fc_lag2 | i | ID) 
   Data: cycles_longer (Number of observations: 570) 
  Draws: 4 chains, each with iter = 6000; warmup = 3000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 88) 
                                                    Estimate
sd(Intercept)                                           0.72
sd(est_estradiol_fc_lag2)                               0.17
sd(est_progesterone_fc_lag2)                            0.03
cor(Intercept,est_estradiol_fc_lag2)                   -0.26
cor(Intercept,est_progesterone_fc_lag2)                -0.11
cor(est_estradiol_fc_lag2,est_progesterone_fc_lag2)     0.10
                                                    Est.Error
sd(Intercept)                                            0.34
sd(est_estradiol_fc_lag2)                                0.07
sd(est_progesterone_fc_lag2)                             0.02
cor(Intercept,est_estradiol_fc_lag2)                     0.47
cor(Intercept,est_progesterone_fc_lag2)                  0.49
cor(est_estradiol_fc_lag2,est_progesterone_fc_lag2)      0.47
                                                    l-95% CI u-95% CI
sd(Intercept)                                           0.10     1.40
sd(est_estradiol_fc_lag2)                               0.05     0.32
sd(est_progesterone_fc_lag2)                            0.00     0.09
cor(Intercept,est_estradiol_fc_lag2)                   -0.85     0.79
cor(Intercept,est_progesterone_fc_lag2)                -0.89     0.84
cor(est_estradiol_fc_lag2,est_progesterone_fc_lag2)    -0.79     0.89
                                                    Rhat Bulk_ESS
sd(Intercept)                                       1.00     1663
sd(est_estradiol_fc_lag2)                           1.02      651
sd(est_progesterone_fc_lag2)                        1.00     1404
cor(Intercept,est_estradiol_fc_lag2)                1.01      711
cor(Intercept,est_progesterone_fc_lag2)             1.00     4776
cor(est_estradiol_fc_lag2,est_progesterone_fc_lag2) 1.00     5148
                                                    Tail_ESS
sd(Intercept)                                           3732
sd(est_estradiol_fc_lag2)                               1688
sd(est_progesterone_fc_lag2)                            2613
cor(Intercept,est_estradiol_fc_lag2)                    2065
cor(Intercept,est_progesterone_fc_lag2)                 7047
cor(est_estradiol_fc_lag2,est_progesterone_fc_lag2)     7309

Population-Level Effects: 
                         Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                    0.38      0.22    -0.03     0.82 1.00
est_estradiol_fc_lag2        0.17      0.05     0.06     0.27 1.00
est_progesterone_fc_lag2    -0.05      0.02    -0.10    -0.01 1.00
cycleZ2                     -0.03      0.05    -0.12     0.07 1.00
                         Bulk_ESS Tail_ESS
Intercept                   19032     9683
est_estradiol_fc_lag2       14482    10340
est_progesterone_fc_lag2    18940     8961
cycleZ2                     25540     7844

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.51      0.02     0.47     0.54 1.00     4467     7815

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>m1_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>~</span> <span class='va'>est_estradiol_fc</span> <span class='op'>+</span> <span class='va'>est_progesterone_fc</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>est_estradiol_fc</span> <span class='op'>+</span> <span class='va'>est_progesterone_fc</span><span class='op'>|</span><span class='va'>i</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span>, <span class='va'>cycles_longer</span>, </span>
<span>            iter <span class='op'>=</span> <span class='fl'>6000</span>, file <span class='op'>=</span> <span class='st'>"m1_i"</span>,</span>
<span>            control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>m1_i</span></span></code></pre>
</div>
</details>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: SR_Intercourse ~ est_estradiol_fc + est_progesterone_fc + cycle + (1 + est_estradiol_fc + est_progesterone_fc | i | ID) 
   Data: cycles_longer (Number of observations: 570) 
  Draws: 4 chains, each with iter = 6000; warmup = 3000; thin = 1;
         total post-warmup draws = 12000

Group-Level Effects: 
~ID (Number of levels: 88) 
                                          Estimate Est.Error l-95% CI
sd(Intercept)                                 0.61      0.30     0.06
sd(est_estradiol_fc)                          0.13      0.07     0.01
sd(est_progesterone_fc)                       0.04      0.03     0.00
cor(Intercept,est_estradiol_fc)              -0.13      0.48    -0.85
cor(Intercept,est_progesterone_fc)           -0.10      0.48    -0.87
cor(est_estradiol_fc,est_progesterone_fc)     0.16      0.46    -0.74
                                          u-95% CI Rhat Bulk_ESS
sd(Intercept)                                 1.28 1.00     1653
sd(est_estradiol_fc)                          0.27 1.00      812
sd(est_progesterone_fc)                       0.11 1.00     1392
cor(Intercept,est_estradiol_fc)               0.83 1.00     1217
cor(Intercept,est_progesterone_fc)            0.84 1.00     3423
cor(est_estradiol_fc,est_progesterone_fc)     0.91 1.00     3410
                                          Tail_ESS
sd(Intercept)                                 1468
sd(est_estradiol_fc)                          1813
sd(est_progesterone_fc)                       3218
cor(Intercept,est_estradiol_fc)               1719
cor(Intercept,est_progesterone_fc)            5540
cor(est_estradiol_fc,est_progesterone_fc)     5403

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept               0.15      0.23    -0.30     0.59 1.00
est_estradiol_fc        0.20      0.06     0.08     0.31 1.00
est_progesterone_fc    -0.04      0.02    -0.08     0.01 1.00
cycleZ2                -0.03      0.05    -0.12     0.06 1.00
                    Bulk_ESS Tail_ESS
Intercept              14741     9070
est_estradiol_fc       10393     4474
est_progesterone_fc    10516     2249
cycleZ2                18084     8375

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.51      0.02     0.48     0.55 1.00     5034     2081

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</details>
<p>Directionally, the same-day imputed hormones has a slightly stronger relationship with SR_Intercourse for oestradiol, and the two-day lag imputation has a slightly stronger relationship with progesterone. Not much that can be concluded at this sample size though.</p>
<h3 id="latent-lag">Latent lag</h3>
<p>Just using the imputations leaves money on the table though. Next, I thought I would use the strong relationship between imputed hormones and measured hormones to impute the missing values two days prior (and thereby carry forward the inherent uncertainty in imputation plus the individual differences, what little there are).</p>
<p>I thought I needed only to use the syntactic sugar for missing variables in brms (<code>mi()</code>). After some reshaping magic, I thought I had it, but, nope, it took forever to fit<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. And I’ve never seen that many warnings from a Stan model before. I did not succeed in fixing them with the usual tricks (more informative priors, inits, playing with control parameters).</p>
<p><strong>Edit:</strong> Sleeping on it, the solution came to me in a dream.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. That solution did not completely fix the model either though. What did it was rereading the brms vignette on missing values and noticing that Paul adds the <code>| mi()</code> also for the main response. This is necessary so brms won’t drop the rows in which the response is missing. I think you can get away with not doing so, if there is overlap, but in my case there was zero overlap (all values that had an outcome did not have lagged steroid measures). So, I added <code>| mi()</code> to by response <code>SR_Intercourse</code>.</p>
<details>
<summary>
Model output
</summary>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mis_imp_formula</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>SR_Intercourse</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='va'>logOESTR_lag2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='va'>logPROG_lag2</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>cycle</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>logOESTR_lag2</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>est_estradiol_fc_lag2</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>logPROG_lag2</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/mi.html'>mi</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>est_progesterone_fc_lag2</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula-helpers.html'>set_rescor</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/get_prior.html'>get_prior</a></span><span class='op'>(</span><span class='va'>mis_imp_formula</span>, data <span class='op'>=</span> <span class='va'>cycles_longer</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span></span>
<span>    prior <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>      <span class='va'>class</span> <span class='op'>==</span> <span class='st'>"b"</span> <span class='op'>&amp;</span> <span class='va'>coef</span> <span class='op'>==</span> <span class='st'>"Intercept"</span> <span class='op'>~</span> <span class='st'>"normal(0, 2)"</span>,</span>
<span>      <span class='va'>class</span> <span class='op'>==</span> <span class='st'>"b"</span>  <span class='op'>~</span> <span class='st'>"normal(0, 1)"</span>,</span>
<span>      <span class='va'>class</span> <span class='op'>==</span> <span class='st'>"sd"</span> <span class='op'>&amp;</span> <span class='va'>coef</span> <span class='op'>==</span> <span class='st'>"Intercept"</span> <span class='op'>~</span> <span class='st'>"student_t(3, 0, 0.5)"</span>,</span>
<span>      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>prior</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='va'>m1lag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span></span>
<span>  <span class='va'>mis_imp_formula</span>,</span>
<span>  <span class='va'>cycles_longer</span>, </span>
<span>  iter <span class='op'>=</span> <span class='fl'>4000</span>, </span>
<span>  init <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>  file <span class='op'>=</span> <span class='st'>"m1_impute_latent"</span>,</span>
<span>  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.99</span>, max_treedepth <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>,</span>
<span>  prior <span class='op'>=</span> <span class='va'>p</span></span>
<span>  <span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
</details>
<p>Instead, I took a leaf out of Matti Vuorre’s book and tried my hand at the nonlinear formula syntax. I find this much less convenient to specify and harder to think about<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>It worries me that the results of the latent lag model are more like the results of the imputations without lag than of those with lag. So maybe I didn’t specify the nonlinear model correctly.</p>
<p><strong>Edit:</strong> I slept on it and I did not, so I’ve cut it here. You can see it on <a href="https://github.com/rubenarslan/rubenarslan.github.io/commit/ac093940892e1bbaa90eeb8bb34512104d8a55a4#diff-f8e17c1a292f30e8f979969d00945c9de5745bdc73be152a919e63dd49389ac6">Github</a> if you wish.</p>
<h3 id="bringing-it-all-together">Bringing it all together</h3>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>draws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span></span>
<span>  latent_impute_lag2 <span class='op'>=</span> <span class='va'>m1lag</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`bsp_SRIntercourse_milog.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.variable <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>.variable</span>, <span class='st'>"bsp_SRIntercourse_mi"</span>, <span class='st'>"b_"</span><span class='op'>)</span>, <span class='st'>"_lag2"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  imputed_lag2 <span class='op'>=</span> <span class='va'>m1_lagi</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_est.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.variable <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>.variable</span>, <span class='st'>"est_estradiol_fc_lag2"</span>, <span class='st'>"logOESTR"</span><span class='op'>)</span>, <span class='st'>"est_progesterone_fc_lag2"</span>, <span class='st'>"logPROG"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  imputed <span class='op'>=</span> <span class='va'>m1_i</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_est.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.variable <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>.variable</span>, <span class='st'>"est_estradiol_fc"</span>, <span class='st'>"logOESTR"</span><span class='op'>)</span>, <span class='st'>"est_progesterone_fc"</span>, <span class='st'>"logPROG"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  latent_group_mean_centered <span class='op'>=</span> <span class='va'>fit_latent</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_SRIntercourse_log[A-Z]+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.variable <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>.variable</span>, <span class='st'>"b_SRIntercourse_"</span>, <span class='st'>"b_"</span><span class='op'>)</span>, <span class='st'>"_Intercept"</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  group_mean_centered <span class='op'>=</span> <span class='va'>m1intercoursegmc</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_log.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>  location_scale <span class='op'>=</span> <span class='va'>m1intercourse_sigma</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_log.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>,</span>
<span>  multivariate <span class='op'>=</span> <span class='va'>m1mv</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_SRIntercourse_log.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>.variable <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace</a></span><span class='op'>(</span><span class='va'>.variable</span>, <span class='st'>"b_SRIntercourse_"</span>, <span class='st'>"b_"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  raw <span class='op'>=</span> <span class='va'>m1intercourse</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='http://mjskay.github.io/tidybayes/reference/spread_draws.html'>gather_draws</a></span><span class='op'>(</span><span class='va'>`b_log.+`</span>, regex <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>, .id <span class='op'>=</span> <span class='st'>"model"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>   <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_inorder.html'>fct_inorder</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>draws</span> <span class='op'>&lt;-</span> <span class='va'>draws</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>model</span>, <span class='va'>.variable</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='http://mjskay.github.io/ggdist/reference/point_interval.html'>mean_hdci</a></span><span class='op'>(</span>.width <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.95</span>, <span class='fl'>.99</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>draws</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>.variable</span>, x <span class='op'>=</span> <span class='va'>.value</span>, xmin <span class='op'>=</span> <span class='va'>.lower</span>, xmax <span class='op'>=</span> <span class='va'>.upper</span>,</span>
<span>                  color <span class='op'>=</span> <span class='va'>model</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='http://mjskay.github.io/ggdist/reference/geom_pointinterval.html'>geom_pointinterval</a></span><span class='op'>(</span>position <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/position_dodge.html'>position_dodge</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>, linetype <span class='op'>=</span> <span class='st'>'dashed'</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html'>scale_color_discrete</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>draws</span><span class='op'>$</span><span class='va'>model</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.99</span>,<span class='fl'>0.99</span><span class='op'>)</span>,</span>
<span>        legend.justification <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment_files/figure-html5/unnamed-chunk-14-1.png" alt="Non-varying slopes for log estradiol and log progesterone" width="576" />
<p class="caption">
Figure 3: Non-varying slopes for log estradiol and log progesterone
</p>
</div>
</div>
<h2 id="conclusion">“Conclusion”</h2>
<p>In summary, I would say my different analyses did not yield very different conclusions at this sample size. If the authors had shared even more data, maybe slightly cooler reanalyses would be possible. Who knows maybe that twofold change in the effect size for estradiol when bringing in imputations and lags is real.</p>
<p>I ended up not bothering to bring it all together in one model, but would be interested to see what happens if you, dear reader, give it a go. Given the rest of the literature, I still put stock in a peri-ovulatory sexual desire peak, but I think this is more evidence that we all should design studies to detect small effects (here and most elsewhere in psychology) and effect heterogeneity (especially here).</p>
<p>Cycle researchers have recently started sharing data more widely. It’s cool to see this catch on even in medicine and I hope it continues.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> I think there are interesting substantive and statistical questions both remaining to be answered in this research.</p>
<h3 id="things-i-didnt-do-or-that-still-confuse-me">Things I didn’t do or that still confuse me</h3>
<ul>
<li>I didn’t do any model comparisons here.</li>
<li>I never brought it all together in one multivariate location-scale model with imputations and lags</li>
<li>I didn’t do any group mean centering at the level of the cycle.</li>
<li>It confuses me that the results of the latent lag model are more like the results of the imputations without lag than of those with lag.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>their previous publications on different outcomes in the same study unfortunately didn’t do so<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>which, according to the first folk theorem of statistical computing, means there’s something wrong with my model<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I had confused which imputations to use as predictors and should have used the lagged ones.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>If I wanted to be mean, I’d say it feels a little like MPlus with those very strict rules about how variables and parameters can be named.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>It would be extra cool if preregistration catches on there outside the narrow remit of clinical trials too.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Reanalysis%3A%20Sexual%20attraction%20to%20visual%20sexual%20stimuli%20and%20hormones&amp;url=https%3A%2F%2Frubenarslan.github.io%2Fposts%2F2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Frubenarslan.github.io%2Fposts%2F2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://livetoblunder.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/';
  this.page.identifier = 'posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://livetoblunder.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
  <p>
    <div class="subscribe"><form method='post' action='https://blogtrottr.com'>
  <p>Get notified of new posts via email:</p>
  <input type='text' name='btr_email' />
  <input type='hidden' name='btr_url'
         value='https://rubenarslan.github.io/blog.xml'/>
  <input type='hidden' name='schedule_type' value='0' />
  <input type='submit' value='Subscribe' />
</form>
</div>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/rubenarslan/rubenarslan.github.io/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/rubenarslan/rubenarslan.github.io">https://github.com/rubenarslan/rubenarslan.github.io</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Arslan (2023, Feb. 22). One lives only to make blunders: Reanalysis: Sexual attraction to visual sexual stimuli and hormones. Retrieved from https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{arslan2023reanalysis:,
  author = {Arslan, Ruben C.},
  title = {One lives only to make blunders: Reanalysis: Sexual attraction to visual sexual stimuli and hormones},
  url = {https://rubenarslan.github.io/posts/2023-02-21-reanalysis-sexual-attraction-to-visual-sexual-stimuli-in-association-with-steroid-hormones-across-menstrual-cycles-and-fertility-treatment/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2018-2021 Ruben Arslan. <a href="../../about.html">Privacy
Policy</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
